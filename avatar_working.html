<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Graph-Reasoned LVM for USL Translation - Infectious Disease Screening</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 50%, #2980b9 100%);
            color: white;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 30px;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 3em;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .main-layout {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .avatar-panel {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 25px;
            backdrop-filter: blur(10px);
        }

        .panel-title {
            font-size: 1.5em;
            margin-bottom: 20px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.3);
            padding-bottom: 10px;
        }

        .avatar-container {
            width: 100%;
            height: 500px;
            background: #4a5568;
            border-radius: 15px;
            position: relative;
            overflow: hidden;
            margin-bottom: 20px;
        }

        .avatar-container canvas {
            display: block;
            width: 100% !important;
            height: 100% !important;
        }

        .avatar-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .avatar-btn {
            background: rgba(255, 255, 255, 0.9);
            border: none;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .avatar-btn:hover {
            background: rgba(255, 255, 255, 1);
            transform: translateY(-2px);
        }

        .form-input {
            width: 100%;
            padding: 8px 12px;
            border: none;
            border-radius: 5px;
            background: rgba(255, 255, 255, 0.9);
            color: #333;
            font-size: 14px;
            margin-bottom: 10px;
        }

        .status-display {
            background: rgba(0, 0, 0, 0.3);
            padding: 10px;
            border-radius: 5px;
            margin-top: 15px;
            font-size: 12px;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üß† USL Translation System</h1>
            <p>3D Avatar Sign Language Synthesis</p>
        </div>

        <div class="main-layout">
            <div class="avatar-panel">
                <div class="panel-title">ü§ñ USL Synthesis Avatar</div>

                <!-- 3D Avatar Container -->
                <div id="avatar-container" class="avatar-container"></div>

                <!-- Avatar Controls -->
                <div class="avatar-controls">
                    <button class="avatar-btn" onclick="playAnimation()">‚ñ∂Ô∏è Play</button>
                    <button class="avatar-btn" onclick="pauseAnimation()">‚è∏Ô∏è Pause</button>
                    <button class="avatar-btn" onclick="resetPose()">üîÑ Reset</button>
                </div>

                <!-- Manual Synthesis -->
                <input type="text" id="text-input" class="form-input" placeholder="Enter text to synthesize...">
                <button class="avatar-btn" onclick="synthesizeUSL()" style="width: 100%;">üé≠ Synthesize USL</button>

                <!-- Status Display -->
                <div id="status-display" class="status-display">üé≠ Avatar Loading...</div>
            </div>
        </div>
    </div>

    <!-- Three.js Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>

    <script>
        // Global variables
        let scene, camera, renderer, controls, model;

        function init() {
            initAvatar();
        }

        function initAvatar() {
            // Scene setup - LIGHTER BACKGROUND
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x4a5568);

            // Camera setup
            const container = document.getElementById('avatar-container');
            const containerWidth = container.clientWidth;
            const containerHeight = 500;
            camera = new THREE.PerspectiveCamera(45, containerWidth / containerHeight, 0.1, 1000);
            camera.position.set(0, 1, 3);
            camera.lookAt(0, 1, 0);

            // Renderer setup
            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(containerWidth, containerHeight);
            renderer.shadowMap.enabled = true;
            container.appendChild(renderer.domElement);

            // MUCH BRIGHTER LIGHTING
            const ambientLight = new THREE.AmbientLight(0xffffff, 1.2);
            scene.add(ambientLight);

            const keyLight = new THREE.DirectionalLight(0xffffff, 3.5);
            keyLight.position.set(5, 8, 5);
            keyLight.castShadow = true;
            scene.add(keyLight);

            const fillLight = new THREE.DirectionalLight(0xffffff, 2.0);
            fillLight.position.set(0, 3, 8);
            scene.add(fillLight);

            const leftLight = new THREE.DirectionalLight(0xffffff, 1.5);
            leftLight.position.set(-8, 4, 2);
            scene.add(leftLight);

            const rightLight = new THREE.DirectionalLight(0xffffff, 1.5);
            rightLight.position.set(8, 4, 2);
            scene.add(rightLight);

            // Create fallback avatar immediately
            createFallbackAvatar();

            // Start render loop
            animate();

            updateStatus('‚úÖ Avatar Ready!');
        }

        function createFallbackAvatar() {
            const avatarGroup = new THREE.Group();

            // LIGHT SKIN COLORS
            const skinColor = 0xFFDBAC;
            const clothingColor = 0x4A90E2;

            // Body
            const bodyGeometry = new THREE.CapsuleGeometry(0.3, 0.9, 8, 16);
            const bodyMaterial = new THREE.MeshStandardMaterial({
                color: clothingColor,
                roughness: 0.7,
                metalness: 0.1
            });
            const body = new THREE.Mesh(bodyGeometry, bodyMaterial);
            body.position.y = 0.8;
            body.castShadow = true;
            avatarGroup.add(body);

            // Head
            const headGeometry = new THREE.SphereGeometry(0.2, 16, 12);
            const headMaterial = new THREE.MeshStandardMaterial({
                color: skinColor,
                roughness: 0.6
            });
            const head = new THREE.Mesh(headGeometry, headMaterial);
            head.position.y = 1.5;
            head.castShadow = true;
            avatarGroup.add(head);

            // Arms
            const armGeometry = new THREE.CapsuleGeometry(0.1, 0.6, 6, 8);
            const armMaterial = new THREE.MeshStandardMaterial({
                color: skinColor,
                roughness: 0.6
            });

            const leftArm = new THREE.Mesh(armGeometry, armMaterial);
            leftArm.position.set(-0.45, 1.0, 0);
            leftArm.rotation.z = Math.PI / 6;
            leftArm.castShadow = true;
            leftArm.name = 'leftArm';
            avatarGroup.add(leftArm);

            const rightArm = new THREE.Mesh(armGeometry, armMaterial);
            rightArm.position.set(0.45, 1.0, 0);
            rightArm.rotation.z = -Math.PI / 6;
            rightArm.castShadow = true;
            rightArm.name = 'rightArm';
            avatarGroup.add(rightArm);

            // Hands - VERY LIGHT
            const handGeometry = new THREE.SphereGeometry(0.08, 8, 8);
            const handMaterial = new THREE.MeshStandardMaterial({
                color: 0xFFE4C4,
                roughness: 0.5
            });

            const leftHand = new THREE.Mesh(handGeometry, handMaterial);
            leftHand.position.set(-0.45, 0.65, 0);
            leftHand.castShadow = true;
            leftHand.name = 'leftHand';
            avatarGroup.add(leftHand);

            const rightHand = new THREE.Mesh(handGeometry, handMaterial);
            rightHand.position.set(0.45, 0.65, 0);
            rightHand.castShadow = true;
            rightHand.name = 'rightHand';
            avatarGroup.add(rightHand);

            // Legs
            const legGeometry = new THREE.CapsuleGeometry(0.12, 0.7, 6, 8);
            const legMaterial = new THREE.MeshStandardMaterial({
                color: 0x2C3E50,
                roughness: 0.8
            });

            const leftLeg = new THREE.Mesh(legGeometry, legMaterial);
            leftLeg.position.set(-0.18, 0.15, 0);
            leftLeg.castShadow = true;
            avatarGroup.add(leftLeg);

            const rightLeg = new THREE.Mesh(legGeometry, legMaterial);
            rightLeg.position.set(0.18, 0.15, 0);
            rightLeg.castShadow = true;
            avatarGroup.add(rightLeg);

            model = avatarGroup;
            scene.add(model);
        }

        function animate() {
            requestAnimationFrame(animate);
            renderer.render(scene, camera);
        }

        function playAnimation() {
            if (!model) return;

            // Simple wave animation
            const leftArm = model.children.find(c => c.name === 'leftArm');
            const rightArm = model.children.find(c => c.name === 'rightArm');

            if (leftArm && rightArm) {
                let count = 0;
                const waveInterval = setInterval(() => {
                    if (count < 6) {
                        const angle = count % 2 === 0 ? Math.PI / 3 : -Math.PI / 6;
                        leftArm.rotation.x = angle;
                        rightArm.rotation.x = -angle;
                        count++;
                    } else {
                        clearInterval(waveInterval);
                        resetPose();
                    }
                }, 300);
            }

            updateStatus('‚ñ∂Ô∏è Animation Playing');
        }

        function pauseAnimation() {
            resetPose();
            updateStatus('‚è∏Ô∏è Animation Paused');
        }

        function resetPose() {
            if (!model) return;

            const leftArm = model.children.find(c => c.name === 'leftArm');
            const rightArm = model.children.find(c => c.name === 'rightArm');
            const leftHand = model.children.find(c => c.name === 'leftHand');
            const rightHand = model.children.find(c => c.name === 'rightHand');

            if (leftArm) {
                leftArm.rotation.set(0, 0, Math.PI / 6);
                leftArm.position.set(-0.45, 1.0, 0);
            }
            if (rightArm) {
                rightArm.rotation.set(0, 0, -Math.PI / 6);
                rightArm.position.set(0.45, 1.0, 0);
            }
            if (leftHand) leftHand.position.set(-0.45, 0.65, 0);
            if (rightHand) rightHand.position.set(0.45, 0.65, 0);

            model.rotation.set(0, 0, 0);

            updateStatus('üîÑ Pose Reset');
        }

        function synthesizeUSL() {
            const text = document.getElementById('text-input').value.trim();
            if (!text) {
                alert('Please enter text to synthesize');
                return;
            }

            updateStatus('üé≠ Synthesizing: ' + text);
            playAnimation();
        }

        function updateStatus(message) {
            const statusEl = document.getElementById('status-display');
            if (statusEl) {
                statusEl.textContent = message;
            }
        }

        // Initialize on load
        window.addEventListener('load', init);

        // Make functions global
        window.playAnimation = playAnimation;
        window.pauseAnimation = pauseAnimation;
        window.resetPose = resetPose;
        window.synthesizeUSL = synthesizeUSL;
    </script>
</body>
</html>
